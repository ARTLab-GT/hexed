<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>hexed: Running Hexed</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">hexed
   &#160;<span id="projectnumber">0.2.0</span>
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('running.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Running Hexed </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="hexecute"></a>Technically, Hexed is really two things. It is a C++ library, and it is an executable program. If you want to extend the functionality of Hexed or use it as a backend and develop your own UI, you should link with the C++ library <code>libhexed.so</code> (use CMake to import the package <code>hexed</code>, and you will have access to everything in the namespace <a class="el" href="namespacehexed.html">hexed</a>). However, for most use cases, the executable should be sufficient. To distinguish it from the library and namespace, the command to <em>execute hexed</em> is <code>hexecute</code> (sorry for my terrible sense of humor). It supports a text-based interface in the <a class="el" href="hil.html">Hexed Interface Language</a>.</p>
<p>To run a typical simulation, you should create a script and run it with something like <code>hexecute your-script.hil</code>. A script should generally including the items below, in order. Note that some of the commands you include are <a class="el" href="hil.html#Macros">Macros</a>, which have to be invoked with <code>$</code>, whereas others are <a class="el" href="hil.html#heisenberg">Heisenberg variables</a> for which you do not use <code>$</code>.</p><ol type="1">
<li>define <a class="el" href="parameters.html#important_inputs">basic input parameters</a></li>
<li><code>$start</code></li>
<li><code>$mesh</code></li>
<li><code>init_state</code></li>
<li><code>$run</code></li>
</ol>
<p>If you just want to generate a mesh for a different solver, then you can do:</p><ol type="1">
<li>define input parameters<ul>
<li>If you're not running iterations, you don't have to define <a class="el" href="parameters.html#done">done</a>, but you do still have to define freestream conditions, even though their value is irrelevant.</li>
</ul>
</li>
<li><code>$start</code></li>
<li><code>$mesh</code></li>
<li><code>write_mesh</code> or <code>export_polymesh</code></li>
<li>If you want to be able to directly visualize the mesh for debugging, you can add:<ol type="a">
<li><code>init_state</code></li>
<li><code>visualize</code></li>
</ol>
</li>
</ol>
<p>A good example of a meshing-only case is the <a href="https://github.com/ARTLab-GT/hexed/tree/main/samples/multielement_airfoil">multielement airfoil</a> case. We currently do not have the physics necessary to obtain realistic results for this case, so we only generate the mesh.</p>
<p>A good example of a basic simulation is the oblique shock case located in <a href="https://github.com/ARTLab-GT/hexed/tree/main/samples/oblique_shock">samples/oblique_shock</a>. In this directory, you should see two files&mdash;<code>run.hil</code> is the input script (name and extension are arbitrary), and <code>geom.csv</code> is a CSV file containing coordinates for a wedge geometry (see <a class="el" href="parameters.html#add_geom">add_geom</a> for more information). To run this case, just type <code>hexecute run.hil</code>. You should see text output that looks something like: </p><div class="fragment"><div class="line">Commencing simulation with Hexed version 0.1.2 (commit 9f5e8a7bd88c464f56c4f5681f802da8bc94d121) at 2024-02-14 23:39:09 UTC (1707953949 Unix Time).</div>
<div class="line">meshing...</div>
<div class="line">    geometry-based refinement sweep 0... done</div>
<div class="line">meshing complete with 953 elements</div>
<div class="line"> </div>
<div class="line">      iteration, normalized_residual,       flow_time,       time_step, art_visc_residual</div>
<div class="line">            100,      3.63832762e-01,  1.00000000e+03,  1.00000000e+00,    1.80119128e-02</div>
<div class="line">            200,      4.25349338e-01,  2.00000000e+03,  1.00000000e+00,    3.68832565e-03</div>
<div class="line">            300,      2.06909093e-01,  3.00000000e+03,  1.00000000e+00,    3.59718903e-03</div>
<div class="line">            400,      8.00037011e-02,  4.00000000e+03,  1.00000000e+00,    3.12172465e-03</div>
<div class="line">            500,      8.18038829e-02,  5.00000000e+03,  1.00000000e+00,    2.66595033e-03</div>
<div class="line">            600,      6.51694373e-02,  6.00000000e+03,  1.00000000e+00,    2.08025464e-03</div>
<div class="line">            700,      4.95621245e-02,  7.00000000e+03,  1.00000000e+00,    1.83239963e-03</div>
<div class="line">            800,      3.60705212e-02,  8.00000000e+03,  1.00000000e+00,    1.25610899e-03</div>
<div class="line">            900,      2.85616889e-02,  9.00000000e+03,  1.00000000e+00,    8.77901998e-04</div>
<div class="line">           1000,      2.25270756e-02,  1.00000000e+04,  1.00000000e+00,    5.53306743e-04</div>
<div class="line">writing mesh/state data...done</div>
<div class="line">visualizing...done</div>
<div class="line">           1100,      1.64693476e-02,  1.10000000e+04,  1.00000000e+00,    4.04425504e-04</div>
<div class="line">           1200,      1.14690508e-02,  1.20000000e+04,  1.00000000e+00,    2.48039501e-04</div>
</div><!-- fragment --><p> ... etc. The <code>iteration</code> column tells you what iteration you're on (note that it doesn't print output on every iteration) and the <code>normalized_residual</code> column tells you the \( L^2 \) norm residual of the Navier-Stokes equations, normalized by the value after the first iteration. The <code>art_visc_residual</code> gives you a measure of the residual of the auxiliary PDEs used to determine the artificial viscosity coefficient. It will not appear if you run a simulation without artificial viscosity. If both of these residuals vanish, the simulation has reached iterative convergence. The <code>flow_time</code> and <code>time_step</code> variables are meaningless in this case because local time stepping is used, but for a simulation with global time stepping their meaning should be self-explanatory. As soon as you start the solver, a directory called <code>hexed_out</code> will be created. In this directory will be a copy of the input file as well as a file <code>output.txt</code> with a copy of the command line output. Also, each time you see <code>visualizing...done</code> in the command line output, the solver will have written a new set of <code>.h5</code> and <code>.xmf</code> files to this directory. You can view these files in Paraview by opening the <code>.xmf</code> (not <code>.h5</code>) files and selecting "XDMF Reader T" as the reader. Each time you see <code>writing mesh/state data...done</code>, the solver will have written a new set of mesh and state files that you can use to restart the simulation from where you left off with <a class="el" href="parameters.html#read_mesh">read_mesh</a> and <a class="el" href="parameters.html#read_state">read_state</a>. Unlike many solvers, Hexed saves new mesh and state data files every time instead of overwriting old ones. In my experience, worrying about overwriting important restart files can be a bit of a headache, and avoiding that problem is worth a little extra disk space. Finally, the <code>hexed_out</code> directory will also contain an empty <code>runtime_cmd.hil</code><a class="anchor" id="runtime_cmd"></a>. Every time the solver prints output, it will execute the contents of this file as <a class="el" href="hil.html">HIL</a> code and then overwrite it again with an empty file. Thus by writing HIL code to this file you can control the solver while it is running. I frequently use this to change the <a class="el" href="parameters.html#done">termination condition</a> or the <a class="el" href="parameters.html#max_safety">CFL constraint</a>.</p>
<p>When the simulation is completed, you should see something like: </p><div class="fragment"><div class="line">           2400,      1.22283438e-04,  2.40000000e+04,  1.00000000e+00,    4.46415343e-06</div>
<div class="line">           2500,      8.42677583e-05,  2.50000000e+04,  1.00000000e+00,    3.19497299e-06</div>
<div class="line">simulation complete</div>
<div class="line">wall clock time = 91.5954s = 1.52659min = 0.0254432hr</div>
<div class="line"> </div>
<div class="line">performance summary:</div>
<div class="line">2382500 (element*iteration)s completed in 77.911 s at 3.27013e-05 s / (element*iteration).</div>
<div class="line">    boundary conditions: 6503380 (boundary connection)*(time integration stage)s completed in 5.5712 s at 8.56663e-07 s / (boundary connection)*(time integration stage).</div>
<div class="line">    cartesian: 2215000 (element*iteration)s completed in 39.307 s at 1.77458e-05 s / (element*iteration).</div>
<div class="line">        compute time step: 22150000 (element*iteration)s completed in 5.2021 s at 2.34858e-07 s / (element*iteration).</div>
<div class="line">        local: 44323036 (element*(time integration stage))s completed in 27.1661 s at 6.12911e-07 s / (element*(time integration stage)).</div>
<div class="line">        neighbor: 130815636 (connection*(time integration stage))s completed in 3.79712 s at 2.90265e-08 s / (connection*(time integration stage)).</div>
<div class="line">        reconcile LDG flux: 22173036 (element*(time integration stage))s completed in 3.12823 s at 1.41083e-07 s / (element*(time integration stage)).</div>
<div class="line">    check admis.: 47650000 (element*iteration)s completed in 4.25091 s at 8.92112e-08 s / (element*iteration).</div>
<div class="line">    deformed: 167500 (element*iteration)s completed in 4.53736 s at 2.70887e-05 s / (element*iteration).</div>
<div class="line">        compute time step: 1675000 (element*iteration)s completed in 0.459999 s at 2.74626e-07 s / (element*iteration).</div>
<div class="line">        local: 3351742 (element*(time integration stage))s completed in 2.96925 s at 8.85882e-07 s / (element*(time integration stage)).</div>
<div class="line">        neighbor: 17111856 (connection*(time integration stage))s completed in 0.782863 s at 4.57497e-08 s / (connection*(time integration stage)).</div>
<div class="line">        reconcile LDG flux: 1676742 (element*(time integration stage))s completed in 0.312915 s at 1.86621e-07 s / (element*(time integration stage)).</div>
<div class="line">    fix admis.: 0 (element*(fix admis. iter))s completed in 4.3366 s.</div>
<div class="line">        cartesian: 0 (element*iteration)s completed in 0 s.</div>
<div class="line">            compute time step: 0 (element*iteration)s completed in 0 s.</div>
<div class="line">            local: 0 (element*(time integration stage))s completed in 0 s.</div>
<div class="line">            neighbor: 0 (connection*(time integration stage))s completed in 0 s.</div>
<div class="line">            reconcile LDG flux: 0 (element*(time integration stage))s completed in 0 s.</div>
<div class="line">        deformed: 0 (element*iteration)s completed in 0 s.</div>
<div class="line">            compute time step: 0 (element*iteration)s completed in 0 s.</div>
<div class="line">            local: 0 (element*(time integration stage))s completed in 0 s.</div>
<div class="line">            neighbor: 0 (connection*(time integration stage))s completed in 0 s.</div>
<div class="line">            reconcile LDG flux: 0 (element*(time integration stage))s completed in 0 s.</div>
<div class="line">    prolong/restrict: 0 (element*(time integration stage))s completed in 0.818223 s.</div>
<div class="line">    set art visc: 2382500 (element*iteration)s completed in 20.1499 s at 8.45747e-06 s / (element*iteration).</div>
<div class="line">        advection: 2382500 (element*iteration)s completed in 5.65127 s at 2.37199e-06 s / (element*iteration).</div>
<div class="line">            BCs: 9530000 (element*(time integration stage))s completed in 0.0878124 s at 9.21431e-09 s / (element*(time integration stage)).</div>
<div class="line">            cartesian: 4430000 (element*iteration)s completed in 4.36745 s at 9.85879e-07 s / (element*iteration).</div>
<div class="line">                compute time step: 2215000 (element*iteration)s completed in 0.118299 s at 5.34082e-08 s / (element*iteration).</div>
<div class="line">                local: 8860000 (element*(time integration stage))s completed in 3.70495 s at 4.18166e-07 s / (element*(time integration stage)).</div>
<div class="line">                neighbor: 17430000 (connection*(time integration stage))s completed in 0.542288 s at 3.11123e-08 s / (connection*(time integration stage)).</div>
<div class="line">            deformed: 335000 (element*iteration)s completed in 0.471364 s at 1.40706e-06 s / (element*iteration).</div>
<div class="line">                compute time step: 167500 (element*iteration)s completed in 0.0155467 s at 9.28159e-08 s / (element*iteration).</div>
<div class="line">                local: 670000 (element*(time integration stage))s completed in 0.352525 s at 5.26157e-07 s / (element*(time integration stage)).</div>
<div class="line">                neighbor: 2280000 (connection*(time integration stage))s completed in 0.101534 s at 4.45325e-08 s / (connection*(time integration stage)).</div>
<div class="line">            setup: 2382500 (element*iteration)s completed in 0.456895 s at 1.91771e-07 s / (element*iteration).</div>
<div class="line">            update: 2382500 (element*(time integration stage))s completed in 0 s at 0 s / (element*(time integration stage)).</div>
<div class="line">        diffusion: 2382500 (element*iteration)s completed in 13.9486 s at 5.85462e-06 s / (element*iteration).</div>
<div class="line">            cartesian: 0 (element*iteration)s completed in 11.1789 s.</div>
<div class="line">                compute time step: 2215000 (element*iteration)s completed in 0.101966 s at 4.60343e-08 s / (element*iteration).</div>
<div class="line">                local: 22150000 (element*(time integration stage))s completed in 7.7929 s at 3.51824e-07 s / (element*(time integration stage)).</div>
<div class="line">                neighbor: 87150000 (connection*(time integration stage))s completed in 0.976395 s at 1.12036e-08 s / (connection*(time integration stage)).</div>
<div class="line">                reconcile LDG flux: 22150000 (element*(time integration stage))s completed in 2.30009 s at 1.03841e-07 s / (element*(time integration stage)).</div>
<div class="line">            deformed: 0 (element*iteration)s completed in 1.67144 s.</div>
<div class="line">                compute time step: 167500 (element*iteration)s completed in 0.0143642 s at 8.57565e-08 s / (element*iteration).</div>
<div class="line">                local: 1675000 (element*(time integration stage))s completed in 1.11925 s at 6.68208e-07 s / (element*(time integration stage)).</div>
<div class="line">                neighbor: 11400000 (connection*(time integration stage))s completed in 0.264148 s at 2.31709e-08 s / (connection*(time integration stage)).</div>
<div class="line">                reconcile LDG flux: 1675000 (element*(time integration stage))s completed in 0.265895 s at 1.58743e-07 s / (element*(time integration stage)).</div>
<div class="line">        initialize: 2382500 (element*iteration)s completed in 0.0917232 s at 3.84987e-08 s / (element*iteration).</div>
</div><!-- fragment --><p> <code>simulation complete</code> tells you that the user-specified termination condition was met (in this case, a bound on <code>normalized_residual</code>; see <a class="el" href="parameters.html#done">done</a>). Below, you will see the elapsed time for which the simulation was running as well as some data on the kernel performance. Thus, you have completed a successful simulation. See the other sample cases for examples of more complex usage. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
